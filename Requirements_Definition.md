# 要件定義書 - 光源分布オプションの実装

## 1. 概要
シミュレータにおいて、実際の露光装置に近い照明条件を再現するため、光源プロファイルを Top-hat（一様分布）と Gaussian（ガウス分布）から選択できる機能を実装する。

## 2. サポートするプロファイル
- **Top-hat (一様分布)**: 従来の形式。照明瞳内のすべての光源点が均一な重みを持つ。
- **Gaussian (ガウス分布)**: 瞳の中心で強度が最大となり、半径方向にガウス分布に従って減衰する。

## 3. Gaussian 分布の仕様
- **定義**: 瞳の中心からの距離を $r$ としたときの強度 $I(r)$ を以下のように定義する。
  $$I(r) = I_0 \cdot \exp\left(-2 \cdot \left(\frac{r}{Rs}\right)^2 \cdot g^2\right)$$
  ここで：
  - $Rs = \sigma \cdot NA / \lambda$ (瞳半径)
  - $g$ は **Gaussian Sigma (1/σ)** パラメータ（プログラム上の変数名：`sigma_g`）。
  - $I_0$ は中心強度（1.0に規格化）。
- **パラメータ $g$ (1/σ) の意味**:
  - $g$ が大きくなる（1/σが大きくなる）ほど、指数の係数が大きくなり、強度 $I(r)$ はより急速に減衰します。
  - 数式上、$g$ は分母 $Rs$ を実質的に $Rs/g$ に縮小させる効果を持つため、値が大きくなるほどプロファイルは「鋭く（狭く）」なります。
- **デフォルト挙動**: $g = 1.0$ のとき、瞳の境界 ($r = Rs$) における強度が中心の $1/e^2 \approx 13.5\%$ となります。

## 4. 重み付け積算のロジック
- 最終的な像強度 $I_{total}$ は、各光源点からのコヒーレント像 $I_i$ にそれぞれの重み $W_i$ を乗じて積算した平均値とする。
  $$I_{total} = \frac{\sum (I_i \cdot W_i)}{\sum W_i}$$
  ここで $W_i$ は、指定されたプロファイルに基づく各光源点の位置における強度値とする。

## 5. UI 要件
- **LS Type セレクタ**: "Top-hat" と "Gaussian" を切り替えるラジオボタンを追加。
- **Gaussian Sigma 入力**: $g$ パラメータを指定する入力フィールドを追加（"Gaussian" 選択時のみ有効、または全般設定として追加）。デフォルト値は 1.0。
